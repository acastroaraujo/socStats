<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Social Statistics I (Exercises) - 6&nbsp; Week 6</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./week07.html" rel="next">
<link href="./week05.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link rel="stylesheet" media="screen" href="https://www.cssfontstack.com/Optima" type="text/css">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./sec2.html">Data, sampling, and probability</a></li><li class="breadcrumb-item"><a href="./week06.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Week 6</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Social Statistics I (Exercises)</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./sec1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Computing preliminaries</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Week 1</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Week 2</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./sec2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data, sampling, and probability</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Week 3</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Week 4</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Week 5</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week06.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Week 6</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Week 7</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./sec3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Week 8</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Week 9</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./week10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Week 10</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./sec-solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solutions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./solutions-01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Solutions 1</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./solutions-02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Solutions 2</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./solutions-03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Solutions 3</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./solutions-04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Solutions 4</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./solutions-05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Solutions 5</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./solutions-06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Solutions 6</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./solutions-07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Solutions 7</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./solutions-08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Solutions 8</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./solutions-09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Solutions 9</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-truth-is-known" id="toc-the-truth-is-known" class="nav-link active" data-scroll-target="#the-truth-is-known"><span class="header-section-number">6.1</span> The <em>Truth</em> is Known</a>
  <ul class="collapse">
  <li><a href="#sampling-distributions" id="toc-sampling-distributions" class="nav-link" data-scroll-target="#sampling-distributions"><span class="header-section-number">6.1.1</span> Sampling Distributions</a></li>
  <li><a href="#exercise" id="toc-exercise" class="nav-link" data-scroll-target="#exercise"><span class="header-section-number">6.1.2</span> Exercise</a></li>
  <li><a href="#confidence-intervals" id="toc-confidence-intervals" class="nav-link" data-scroll-target="#confidence-intervals"><span class="header-section-number">6.1.3</span> Confidence Intervals</a></li>
  <li><a href="#nhst" id="toc-nhst" class="nav-link" data-scroll-target="#nhst"><span class="header-section-number">6.1.4</span> NHST</a></li>
  <li><a href="#exercise-1" id="toc-exercise-1" class="nav-link" data-scroll-target="#exercise-1"><span class="header-section-number">6.1.5</span> Exercise</a></li>
  <li><a href="#difference-in-proportions" id="toc-difference-in-proportions" class="nav-link" data-scroll-target="#difference-in-proportions"><span class="header-section-number">6.1.6</span> Difference in Proportions</a></li>
  <li><a href="#exercise-2" id="toc-exercise-2" class="nav-link" data-scroll-target="#exercise-2"><span class="header-section-number">6.1.7</span> Exercise</a></li>
  <li><a href="#exercise-3" id="toc-exercise-3" class="nav-link" data-scroll-target="#exercise-3"><span class="header-section-number">6.1.8</span> Exercise</a></li>
  </ul></li>
  <li><a href="#the-data-is-known" id="toc-the-data-is-known" class="nav-link" data-scroll-target="#the-data-is-known"><span class="header-section-number">6.2</span> The <em>Data</em> is Known</a>
  <ul class="collapse">
  <li><a href="#exercise-4" id="toc-exercise-4" class="nav-link" data-scroll-target="#exercise-4"><span class="header-section-number">6.2.1</span> Exercise</a></li>
  <li><a href="#exercise-5" id="toc-exercise-5" class="nav-link" data-scroll-target="#exercise-5"><span class="header-section-number">6.2.2</span> Exercise</a></li>
  <li><a href="#exercise-6" id="toc-exercise-6" class="nav-link" data-scroll-target="#exercise-6"><span class="header-section-number">6.2.3</span> Exercise</a></li>
  <li><a href="#exercise-7" id="toc-exercise-7" class="nav-link" data-scroll-target="#exercise-7"><span class="header-section-number">6.2.4</span> Exercise</a></li>
  <li><a href="#bonus" id="toc-bonus" class="nav-link" data-scroll-target="#bonus"><span class="header-section-number">6.2.5</span> Bonus</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Week 6</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>The purpose of this week is to understand <em>null hypothesis significance testing</em> (NHST) and <em>confidence intervals.</em> We will be making use of <strong>simulation-based statistical inference</strong> (including permutation testing and bootstrapping).</p>
<p>These are some of the big ideas we will review:</p>
<ul>
<li><p>Sampling Distributions.</p></li>
<li><p>Confidence Intervals.</p></li>
<li><p>P-values and null-hypothesis testing.</p></li>
</ul>
<p>And here are some of the applications we will review:</p>
<ul>
<li><p>Differences in proportions.</p></li>
<li><p>Chi-square ( <span class="math inline">\(\chi^2\)</span> ) tests for independence.</p></li>
</ul>
<p><strong>Set up</strong></p>
<p>Don’t forget to put these lines at the beginning of your quarto document:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(infer)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(janitor) <span class="do">## for convenient "table" functions</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(gssr)    <span class="do">## for access to GSS data</span></span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="do">## You can choose another ggplot2 theme, obviously. </span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="do">## Windows users might not have this font available!</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="fu">theme_set</span>(<span class="fu">theme_light</span>(<span class="at">base_family =</span> <span class="st">"Optima"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>These are some useful readings:</em></p>
<ul>
<li><p>“<a href="http://allendowney.blogspot.com/2016/06/there-is-still-only-one-test.html">There is still only one test</a>” by Allen Downey</p></li>
<li><p>The <a href="https://infer.netlify.app/">documentation</a> for the <code>infer</code> package is pretty good.</p></li>
<li><p>The American Statistical Association’s Statement on Statistical Significance and P-Values.</p>
<p><a href="https://www.tandfonline.com/doi/epdf/10.1080/00031305.2016.1154108" class="uri">https://www.tandfonline.com/doi/epdf/10.1080/00031305.2016.1154108</a></p></li>
</ul>
<section id="the-truth-is-known" class="level2 page-columns page-full" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="the-truth-is-known"><span class="header-section-number">6.1</span> The <em>Truth</em> is Known</h2>
<section id="sampling-distributions" class="level3 page-columns page-full" data-number="6.1.1">
<h3 data-number="6.1.1" class="anchored" data-anchor-id="sampling-distributions"><span class="header-section-number">6.1.1</span> Sampling Distributions</h3>
<p>We have already seen sampling distributions in class.</p>
<p>For example, suppose we know that the true proportion of people voting Democrats is <span class="math inline">\(0.53\)</span>. If we decide to poll <span class="math inline">\(1000\)</span> individuals, what can we say <em>beforehand</em> about the unobserved results?</p>
<p>The following chunk of code simulates this sampling distribution.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>S <span class="ot">&lt;-</span> <span class="fl">1e4</span> <span class="do">## number of simulated draws</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>poll_size <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="do">## sample size</span></span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a>draws <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(S, <span class="at">size =</span> poll_size, <span class="at">prob =</span> <span class="fl">0.53</span>)</span>
<span id="cb2-5"><a href="#cb2-5"></a>proportions <span class="ot">&lt;-</span> draws <span class="sc">/</span> poll_size</span>
<span id="cb2-6"><a href="#cb2-6"></a></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="fu">tibble</span>(proportions) <span class="sc">|&gt;</span> </span>
<span id="cb2-8"><a href="#cb2-8"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(proportions)) <span class="sc">+</span> </span>
<span id="cb2-9"><a href="#cb2-9"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">boundary =</span> <span class="fl">0.5</span>, <span class="at">binwidth =</span> <span class="fl">0.005</span>) <span class="sc">+</span></span>
<span id="cb2-10"><a href="#cb2-10"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sampling Distribution of p = 0.53 and n = 1000"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="week06_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<aside>
The <strong>sampling distribution</strong> is the set of possible sample “statistics” or “data summaries” (e.g., means, proportions) that could have been observed, <em>if the data collection process had been repeated many many times</em>.
</aside>
<p>This sampling distribution is centered around the <em>true value</em> of <span class="math inline">\(0.53\)</span>.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">mean</span>(proportions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5301073</code></pre>
</div>
</div>
<p>The <strong>standard error</strong> is the standard deviation of the sample distribution.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sd</span>(proportions)</span>
<span id="cb5-2"><a href="#cb5-2"></a>se</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01571151</code></pre>
</div>
</div>
<p>Furthermore, this sampling distribution <em>looks</em> normal, which is something we come to expect because of the <strong>Central Limit Theorem</strong>.</p>
<p>In a normal distribution:</p>
<ul>
<li><p>We expect 68% of the values to be within 1 standard deviations around the center.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>lower <span class="ot">&lt;-</span> <span class="fl">0.53</span> <span class="sc">-</span> <span class="dv">1</span><span class="sc">*</span>se</span>
<span id="cb7-2"><a href="#cb7-2"></a>upper <span class="ot">&lt;-</span> <span class="fl">0.53</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span>se</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="fu">mean</span>(proportions <span class="sc">&gt;=</span> lower <span class="sc">&amp;</span> proportions <span class="sc">&lt;=</span> upper)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6779</code></pre>
</div>
</div></li>
<li><p>We expect 95% of the values to be roughly within 2 standard deviations around the mean.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>lower <span class="ot">&lt;-</span> <span class="fl">0.53</span> <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>se</span>
<span id="cb9-2"><a href="#cb9-2"></a>upper <span class="ot">&lt;-</span> <span class="fl">0.53</span> <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>se</span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="fu">mean</span>(<span class="fu">between</span>(proportions, lower, upper)) <span class="do">## using dplyr's between function</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9543</code></pre>
</div>
</div></li>
</ul>
<p>Now that we know this we can ask questions such as what is the probability that a poll of 1000 people tells us that the proportion of people voting Democrats is less than or equal to <span class="math inline">\(0.5\)</span>?</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">mean</span>(proportions <span class="sc">&lt;=</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0315</code></pre>
</div>
</div>
<p>So, the probability is very low. It seems that a poll of 1000 is very likely to declare the correct winner. Researchers do this kind of calculation all the time to make sure their sample size is sufficiently large for their purposes.</p>
<p><strong>Sampling distributions without simulations (aka using Math)</strong></p>
<p>Because of the CLT, we can construct some sampling distributions simply by calculating the center and the spread.</p>
<p>We know the center is <span class="math inline">\(0.53\)</span>, and there’s a convenient formula for calculating the standard error of a proportion:</p>
<p><span class="math display">\[
\text{se}_p = \sqrt{\frac{p(1-p)}{n}} = \sqrt{\frac{0.53 \times 0.47}{1000}} \approx 0.01578
\]</span></p>
<aside>
Learning this formula is worth your time!
</aside>
<p>We can overlay this “analytical” sampling distribution on top of our simulated sampling distribution like this:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">tibble</span>(proportions) <span class="sc">|&gt;</span> </span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(proportions)) <span class="sc">+</span> </span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb13-4"><a href="#cb13-4"></a>    <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">boundary =</span> <span class="fl">0.5</span>, <span class="at">binwidth =</span> <span class="fl">0.005</span>,</span>
<span id="cb13-5"><a href="#cb13-5"></a>    <span class="do">## this is a little hack to ensure the y-axis are the same</span></span>
<span id="cb13-6"><a href="#cb13-6"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density))</span>
<span id="cb13-7"><a href="#cb13-7"></a>  ) <span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sampling Distribution of p = 0.53 and n = 1000"</span>) <span class="sc">+</span></span>
<span id="cb13-9"><a href="#cb13-9"></a>  <span class="do">## adding the normal distribution on top</span></span>
<span id="cb13-10"><a href="#cb13-10"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> \(x) <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="fl">0.53</span>, <span class="at">sd =</span> se)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="week06_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<aside>
Keep in mind that the output of <code>dnorm</code> is labelled “density” whereas we had been calling output of <code>dbinom</code> a “probability.” That’s because binomial distributions are <em>discrete,</em> whereas normal distributions as <em>continuous.</em> We can’t really assign probabilities to continuous numbers because there are infinitely many of them and the math gets weird; thus, we think about them a little differently.
</aside>
<p>We can ask the same question as before: What is the probability that a poll of 1000 people tells us that the proportion of people voting Democrats is less than or equal to <span class="math inline">\(0.5\)</span>? This probability is a <em>tail-area probability.</em> We call them like that because they correspond to that little shaded area under the curve.</p>
<aside>
<em>P-values are also tail area probabilities!</em>
</aside>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="week06_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">pnorm</span>(<span class="fl">0.5</span>, <span class="at">mean =</span> <span class="fl">0.53</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="fl">0.53</span><span class="sc">*</span><span class="fl">0.47</span><span class="sc">/</span><span class="dv">1000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02866469</code></pre>
</div>
</div>
</section>
<section id="exercise" class="level3" data-number="6.1.2">
<h3 data-number="6.1.2" class="anchored" data-anchor-id="exercise"><span class="header-section-number">6.1.2</span> Exercise</h3>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><em>Choosing sample size.</em></p>
<p>You are designing a survey to estimate the proportion of individuals who will vote Democrat. Assuming that respondents are a simple random sample of the voting population, how many people do you need to poll so that the standard error is less than 5 percentage points?</p>
</div>
</div>
</div>
</section>
<section id="confidence-intervals" class="level3 page-columns page-full" data-number="6.1.3">
<h3 data-number="6.1.3" class="anchored" data-anchor-id="confidence-intervals"><span class="header-section-number">6.1.3</span> Confidence Intervals</h3>
<p>Confidence intervals are constructed from the data we get to observe. In the example above, we established that the true population parameter was equal to <span class="math inline">\(0.53\)</span> and that the sample size was equal to <span class="math inline">\(1000\)</span>.</p>
<p>This is how one dataset could look like:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">set.seed</span>(<span class="dv">321</span>)</span>
<span id="cb16-2"><a href="#cb16-2"></a>one_dataset <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(poll_size, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.53</span>)</span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="fu">glimpse</span>(one_dataset) <span class="do">## one thousand observations of 1s and 0s</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> int [1:1000] 0 0 1 1 1 1 1 1 1 0 ...</code></pre>
</div>
</div>
<p>The <em>estimated</em> proportion from this one dataset is calculated as follows:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>prop_hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(one_dataset)</span>
<span id="cb18-2"><a href="#cb18-2"></a>prop_hat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.513</code></pre>
</div>
</div>
<p>It’s increasingly common practice to <em>estimate</em> standard errors using a computational approximation technique called the <strong>bootstrap</strong>.</p>
<p>Bootstrap resampling is done <em>with replacement</em>; that is, the same data point can appear multiple times in a resampled dataset. This is necessary, as otherwise it would not be possible to get new datasets of the same size as the original.</p>
<p>The following chunk of code estimates 10,000 resampled proportions.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>boot_stats <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="fl">1e4</span>, {</span>
<span id="cb20-2"><a href="#cb20-2"></a>  resample <span class="ot">&lt;-</span> <span class="fu">sample</span>(one_dataset, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-3"><a href="#cb20-3"></a>  <span class="fu">mean</span>(resample)</span>
<span id="cb20-4"><a href="#cb20-4"></a>})</span>
<span id="cb20-5"><a href="#cb20-5"></a></span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="fu">glimpse</span>(boot_stats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> num [1:10000] 0.547 0.525 0.521 0.499 0.484 0.52 0.507 0.517 0.494 0.516 ...</code></pre>
</div>
</div>
<p>We can then construct a confidence interval using the <code>quantile()</code> function on the bootstrap statistics.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>ci95 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(boot_stats, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb22-2"><a href="#cb22-2"></a>ci95</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> 2.5% 97.5% 
0.482 0.544 </code></pre>
</div>
</div>
<p>This is how the bootstrap proportions—and the 95% confidence interval—compare to the “true” sampling distribution:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb24-2"><a href="#cb24-2"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb24-3"><a href="#cb24-3"></a>    <span class="at">data =</span> <span class="fu">tibble</span>(proportions),</span>
<span id="cb24-4"><a href="#cb24-4"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(proportions, <span class="at">fill =</span> <span class="st">"sampling distribution"</span>),</span>
<span id="cb24-5"><a href="#cb24-5"></a>    <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb24-6"><a href="#cb24-6"></a>    <span class="at">boundary =</span> <span class="fl">0.5</span>,</span>
<span id="cb24-7"><a href="#cb24-7"></a>    <span class="at">binwidth =</span> <span class="fl">0.005</span></span>
<span id="cb24-8"><a href="#cb24-8"></a>  ) <span class="sc">+</span> </span>
<span id="cb24-9"><a href="#cb24-9"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb24-10"><a href="#cb24-10"></a>    <span class="at">data =</span> <span class="fu">tibble</span>(boot_stats),</span>
<span id="cb24-11"><a href="#cb24-11"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(boot_stats, <span class="at">fill =</span> <span class="st">"bootstrap proportions"</span>),</span>
<span id="cb24-12"><a href="#cb24-12"></a>    <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb24-13"><a href="#cb24-13"></a>    <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, </span>
<span id="cb24-14"><a href="#cb24-14"></a>    <span class="at">boundary =</span> <span class="fl">0.5</span>,</span>
<span id="cb24-15"><a href="#cb24-15"></a>    <span class="at">binwidth =</span> <span class="fl">0.005</span></span>
<span id="cb24-16"><a href="#cb24-16"></a>  ) <span class="sc">+</span></span>
<span id="cb24-17"><a href="#cb24-17"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> ci95, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb24-18"><a href="#cb24-18"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="cn">NULL</span>, <span class="at">title =</span> <span class="st">"95% Confidence Interval"</span>, <span class="at">y =</span> <span class="st">"count"</span>) <span class="sc">+</span></span>
<span id="cb24-19"><a href="#cb24-19"></a>  <span class="fu">annotate</span>(</span>
<span id="cb24-20"><a href="#cb24-20"></a>    <span class="st">"text"</span>, <span class="at">x =</span> prop_hat, <span class="at">y =</span> <span class="dv">500</span>, <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb24-21"><a href="#cb24-21"></a>    <span class="do">## hack for LaTeX expressions in graphs</span></span>
<span id="cb24-22"><a href="#cb24-22"></a>    <span class="at">label =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="fu">paste</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">hat{p} ="</span>, prop_hat))</span>
<span id="cb24-23"><a href="#cb24-23"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="week06_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Confidence intervals without simulations (aka using Math)</strong></p>
<p>We can also <em>estimate</em> standard errors “analytically” using the following formula:</p>
<p><span class="math display">\[
\widehat{\text{se}_p} = \sqrt{\frac{\hat{p}(1-\hat{p})}{n}}
\]</span></p>
<aside>
Note the use of the “hat” symbol in <span class="math inline">\(\hat p\)</span> to indicate that these are <em>estimates</em> from a dataset.
</aside>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>se_hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(prop_hat <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> prop_hat) <span class="sc">/</span> <span class="dv">1000</span>)</span>
<span id="cb25-2"><a href="#cb25-2"></a>se_hat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01580604</code></pre>
</div>
</div>
<p>Assuming that the normal distribution kicks in because of the CLT, we can estimate the 95% confidence interval using the <code>qnorm()</code> function:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), <span class="at">mean =</span> prop_hat, <span class="at">sd =</span> se_hat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4820207 0.5439793</code></pre>
</div>
</div>
<p>In this case, <em>both confidence intervals are identical.</em> But we did have to make more assumptions (e.g., using a normal distribution)! And we also had to use formulas that we might not understand (e.g., the formula for <span class="math inline">\(\widehat{\text{se}_p}\)</span> )!</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>prop_hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(one_dataset)</span>
<span id="cb29-2"><a href="#cb29-2"></a>se_hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(prop_hat <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> prop_hat) <span class="sc">/</span> <span class="dv">1000</span>)</span>
<span id="cb29-3"><a href="#cb29-3"></a>ci95 <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), <span class="at">mean =</span> prop_hat, <span class="at">sd =</span> se_hat)</span>
<span id="cb29-4"><a href="#cb29-4"></a></span>
<span id="cb29-5"><a href="#cb29-5"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6"></a>  <span class="fu">stat_function</span>(</span>
<span id="cb29-7"><a href="#cb29-7"></a>    <span class="at">geom =</span> <span class="st">"area"</span>,</span>
<span id="cb29-8"><a href="#cb29-8"></a>    <span class="at">fun =</span> \(x) <span class="fu">dnorm</span>(x, <span class="fl">0.53</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="fl">0.53</span><span class="sc">*</span><span class="fl">0.47</span><span class="sc">/</span><span class="dv">1000</span>)),</span>
<span id="cb29-9"><a href="#cb29-9"></a>    <span class="at">fill =</span> <span class="st">"steelblue1"</span></span>
<span id="cb29-10"><a href="#cb29-10"></a>  ) <span class="sc">+</span></span>
<span id="cb29-11"><a href="#cb29-11"></a>  <span class="fu">stat_function</span>(</span>
<span id="cb29-12"><a href="#cb29-12"></a>    <span class="at">geom =</span> <span class="st">"area"</span>,</span>
<span id="cb29-13"><a href="#cb29-13"></a>    <span class="at">fun =</span> \(x) <span class="fu">dnorm</span>(x, prop_hat, se_hat),</span>
<span id="cb29-14"><a href="#cb29-14"></a>    <span class="at">fill =</span> <span class="st">"pink"</span>, <span class="at">alpha =</span> <span class="dv">4</span><span class="sc">/</span><span class="dv">5</span></span>
<span id="cb29-15"><a href="#cb29-15"></a>  ) <span class="sc">+</span> </span>
<span id="cb29-16"><a href="#cb29-16"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> ci95, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb29-17"><a href="#cb29-17"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.43</span>, <span class="fl">0.6</span>, <span class="fl">0.02</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.43</span>, <span class="fl">0.6</span>)) <span class="sc">+</span></span>
<span id="cb29-18"><a href="#cb29-18"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"proportions"</span>, <span class="at">y =</span> <span class="st">"density"</span>, <span class="at">title =</span> <span class="st">"95% Confidence Interval"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="week06_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="nhst" class="level3 page-columns page-full" data-number="6.1.4">
<h3 data-number="6.1.4" class="anchored" data-anchor-id="nhst"><span class="header-section-number">6.1.4</span> NHST</h3>
<p>Null Hypothesis Statistical Testing also involves the construction of sampling distributions—i.e., we first construct the sampling distribution of the “null model.”</p>
<p>This procedure can be quite mechanical:</p>
<ol type="1">
<li><p>We assume a hypothesis we would like to refute: a <em>null hypothesis</em> often denoted as <span class="math inline">\(H_0\)</span>.</p></li>
<li><p>We choose a <em>test statistic</em> (e.g., an average, a proportion), which is some function of the observed data.</p></li>
<li><p>We derive the <em>sampling distribution</em> of the test statistic, given the null hypothesis. This distribution is also called the <em>reference distribution</em>.</p></li>
<li><p>We ask whether the observed value of the test statistic is likely to occur under the reference distribution. This probability is also known as a <span class="math inline">\(p\)</span><em>-value</em>.</p>
<p>The <span class="math inline">\(p\)</span>-value is the probability that, under the null hypothesis, we observe a value of the test statistic at least as extreme as the one we actually observed.</p></li>
<li><p>We reject the null hypothesis if the <span class="math inline">\(p\)</span>-value is less than or equal to the confidence level <span class="math inline">\(\alpha\)</span>. Otherwise, we retain the null hypothesis (i.e., we <em>fail to reject</em> the null hypothesis).</p></li>
</ol>
<p>For example, continuing the previous example, suppose that our null model ( <span class="math inline">\(H_0\)</span> ) is that the proportion of people who vote Democrat and Republican is the same—i.e., that <span class="math inline">\(p = 0.5\)</span>.</p>
<p>We can simulate the null distribution as follows:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>S <span class="ot">&lt;-</span> <span class="fl">1e4</span> <span class="do">## number of simulated draws</span></span>
<span id="cb30-2"><a href="#cb30-2"></a>poll_size <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="do">## sample size</span></span>
<span id="cb30-3"><a href="#cb30-3"></a></span>
<span id="cb30-4"><a href="#cb30-4"></a>draws <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(S, <span class="at">size =</span> poll_size, <span class="at">prob =</span> <span class="fl">0.50</span>)</span>
<span id="cb30-5"><a href="#cb30-5"></a>null <span class="ot">&lt;-</span> draws <span class="sc">/</span> poll_size</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<aside>
This is almost the exact same code that we used before. Only the <code>prob</code> argument has changed.
</aside>
<p>We can overlay the null distribution on top of the sampling distribution for the “true” parameter as follows:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb31-2"><a href="#cb31-2"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb31-3"><a href="#cb31-3"></a>    <span class="at">data =</span> <span class="fu">tibble</span>(proportions),</span>
<span id="cb31-4"><a href="#cb31-4"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(proportions, <span class="at">fill =</span> <span class="st">"True Sampling Distribution"</span>),</span>
<span id="cb31-5"><a href="#cb31-5"></a>    <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">boundary =</span> <span class="fl">0.5</span>, <span class="at">binwidth =</span> <span class="fl">0.005</span>,</span>
<span id="cb31-6"><a href="#cb31-6"></a>  ) <span class="sc">+</span></span>
<span id="cb31-7"><a href="#cb31-7"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb31-8"><a href="#cb31-8"></a>    <span class="at">data =</span> <span class="fu">tibble</span>(null),</span>
<span id="cb31-9"><a href="#cb31-9"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(null, <span class="at">fill =</span> <span class="st">"Null Sampling Distribution"</span>),</span>
<span id="cb31-10"><a href="#cb31-10"></a>    <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">boundary =</span> <span class="fl">0.5</span>, <span class="at">binwidth =</span> <span class="fl">0.005</span>,</span>
<span id="cb31-11"><a href="#cb31-11"></a>    <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span></span>
<span id="cb31-12"><a href="#cb31-12"></a>  ) <span class="sc">+</span></span>
<span id="cb31-13"><a href="#cb31-13"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.43</span>, <span class="fl">0.61</span>, <span class="fl">0.02</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.43</span>, <span class="fl">0.61</span>)) <span class="sc">+</span></span>
<span id="cb31-14"><a href="#cb31-14"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="week06_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="864"></p>
</div>
</div>
</section>
<section id="exercise-1" class="level3" data-number="6.1.5">
<h3 data-number="6.1.5" class="anchored" data-anchor-id="exercise-1"><span class="header-section-number">6.1.5</span> Exercise</h3>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>What is the probability of observing the “true” value ( <span class="math inline">\(p = 0.53\)</span> ) under the null?</p>
<p>What is the probability of observing <code>prop_hat</code> under the null? Is this statistically significant if the confidence level ( <span class="math inline">\(\alpha\)</span> ) is set to 0.05?</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Hint: As a reminder, this is how I calculated <code>prop_hat</code> earlier:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="fu">set.seed</span>(<span class="dv">321</span>)</span>
<span id="cb32-2"><a href="#cb32-2"></a>one_dataset <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(poll_size, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.53</span>)</span>
<span id="cb32-3"><a href="#cb32-3"></a>prop_hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(one_dataset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Here, <code>prop_hat</code> is 0.513. If you remove the <code>set.seed(321)</code> line you will get a different value of <code>prop_hat</code>. I encourage you to play around with this.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Hint: You can reach the same decision with NHST and confidence intervals. If your <span class="math inline">\(H_0\)</span> is included within the confidence interval, we then fail to reject the null.</p>
</div>
</div>
</div>
</section>
<section id="difference-in-proportions" class="level3" data-number="6.1.6">
<h3 data-number="6.1.6" class="anchored" data-anchor-id="difference-in-proportions"><span class="header-section-number">6.1.6</span> Difference in Proportions</h3>
<p>We can repeat everything we did before for other scenarios; for example, a difference in proportions.</p>
<p>Suppose we have to groups of people (e.g., men and women) who differ in the proportion of voting Democrat.</p>
<p>For example, we can assume that <span class="math inline">\(p_1 = 0.5\)</span> and that <span class="math inline">\(p_2 = 0.6\)</span>.</p>
<p>Here, the <em>true</em> difference in proportions is <span class="math inline">\(\theta = p_1 - p_2 = -0.1\)</span>.</p>
<p>The following chunk creates a sampling distribution for this new parameter <span class="math inline">\(\theta\)</span>.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb33-2"><a href="#cb33-2"></a>n1 <span class="ot">&lt;-</span> <span class="dv">120</span></span>
<span id="cb33-3"><a href="#cb33-3"></a>p2 <span class="ot">&lt;-</span> <span class="fl">0.6</span></span>
<span id="cb33-4"><a href="#cb33-4"></a>n2 <span class="ot">&lt;-</span> <span class="dv">90</span></span>
<span id="cb33-5"><a href="#cb33-5"></a></span>
<span id="cb33-6"><a href="#cb33-6"></a>S <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb33-7"><a href="#cb33-7"></a>draws1 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(S, <span class="at">size =</span> n1, <span class="at">prob =</span> p1) </span>
<span id="cb33-8"><a href="#cb33-8"></a>proportions1 <span class="ot">&lt;-</span> draws1 <span class="sc">/</span> n1 </span>
<span id="cb33-9"><a href="#cb33-9"></a>draws2 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(S, <span class="at">size =</span> n2, <span class="at">prob =</span> p2)</span>
<span id="cb33-10"><a href="#cb33-10"></a>proportions2 <span class="ot">&lt;-</span> draws2 <span class="sc">/</span> n2</span>
<span id="cb33-11"><a href="#cb33-11"></a>theta_distribution <span class="ot">&lt;-</span> proportions1 <span class="sc">-</span> proportions2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>As before, the sampling distribution is centered around the true value of <span class="math inline">\(-0.1\)</span></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="fu">mean</span>(theta_distribution)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.09997294</code></pre>
</div>
</div>
<p>And the standard error is given by:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="fu">sd</span>(theta_distribution)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.06896817</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="fu">tibble</span>(<span class="at">theta =</span> theta_distribution) <span class="sc">|&gt;</span> </span>
<span id="cb38-2"><a href="#cb38-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(theta)) <span class="sc">+</span> </span>
<span id="cb38-3"><a href="#cb38-3"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">boundary =</span> <span class="fl">0.5</span>, <span class="at">binwidth =</span> <span class="fl">0.025</span>) <span class="sc">+</span></span>
<span id="cb38-4"><a href="#cb38-4"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sampling Distribution of differences in proportions"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="week06_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="exercise-2" class="level3" data-number="6.1.7">
<h3 data-number="6.1.7" class="anchored" data-anchor-id="exercise-2"><span class="header-section-number">6.1.7</span> Exercise</h3>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>The formula for calculating the standard error of a difference in proportions is given by:</p>
<p><span class="math display">\[
\sigma_{\hat p_1 - \hat p_2} = \sqrt{\frac{p_1 (1 - p_1)}{n_1} + \frac{p_2 (1 - p_2)}{n_2}}
\]</span></p>
<p>Verify that this standard error corresponds to <code>sd(theta_distribution)</code>.</p>
</div>
</div>
</div>
</section>
<section id="exercise-3" class="level3" data-number="6.1.8">
<h3 data-number="6.1.8" class="anchored" data-anchor-id="exercise-3"><span class="header-section-number">6.1.8</span> Exercise</h3>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><em>Comparison of proportions.</em></p>
<p>A randomized experiment is performed within a survey. 1000 people are contacted. Half the people contacted are promised a $5 incentive to participate, and half are not promised an incentive. The result is a 50% response rate among the treated group and 40% response rate among the control group. Give an estimate and standard error of the difference in proportions.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Hint: Because this is a randomized experiment, we usually refer to this difference in proportions as an <em>average treatment effect,</em> which we interpret as a causal effect.</p>
</div>
</div>
</div>
</section>
</section>
<section id="the-data-is-known" class="level2 page-columns page-full" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="the-data-is-known"><span class="header-section-number">6.2</span> The <em>Data</em> is Known</h2>
<p>Here we will work with GSS data.</p>
<p>Copy the following chunk of code to get the data frame we will be using.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>gss18 <span class="ot">&lt;-</span> <span class="fu">gss_get_yr</span>(<span class="dv">2018</span>) </span>
<span id="cb39-2"><a href="#cb39-2"></a></span>
<span id="cb39-3"><a href="#cb39-3"></a>d <span class="ot">&lt;-</span> gss18 <span class="sc">|&gt;</span> </span>
<span id="cb39-4"><a href="#cb39-4"></a>  <span class="fu">select</span>(sex, attend, polviews) <span class="sc">|&gt;</span> </span>
<span id="cb39-5"><a href="#cb39-5"></a>  haven<span class="sc">::</span><span class="fu">zap_missing</span>() <span class="sc">|&gt;</span> </span>
<span id="cb39-6"><a href="#cb39-6"></a>  <span class="fu">mutate</span>(<span class="at">sex =</span> <span class="fu">as_factor</span>(sex)) <span class="sc">|&gt;</span> </span>
<span id="cb39-7"><a href="#cb39-7"></a>  haven<span class="sc">::</span><span class="fu">zap_labels</span>() <span class="sc">|&gt;</span> </span>
<span id="cb39-8"><a href="#cb39-8"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb39-9"><a href="#cb39-9"></a></span>
<span id="cb39-10"><a href="#cb39-10"></a><span class="fu">glimpse</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 2,235
Columns: 3
$ sex      &lt;fct&gt; male, male, female, male, female, female, male, female, male,…
$ attend   &lt;dbl&gt; 5, 2, 6, 8, 4, 7, 7, 0, 4, 5, 0, 3, 0, 7, 1, 0, 4, 5, 2, 7, 1…
$ polviews &lt;dbl&gt; 6, 5, 4, 7, 3, 4, 5, 4, 6, 4, 4, 3, 2, 5, 2, 6, 2, 4, 6, 6, 4…</code></pre>
</div>
</div>
<section id="exercise-4" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="exercise-4"><span class="header-section-number">6.2.1</span> Exercise</h3>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Go to the GSS website and describe the values of <code>attend</code> and <code>polviews</code>—e.g., what does a value of “4” mean in <code>polviews</code>.</p>
</div>
</div>
</div>
</section>
<section id="exercise-5" class="level3" data-number="6.2.2">
<h3 data-number="6.2.2" class="anchored" data-anchor-id="exercise-5"><span class="header-section-number">6.2.2</span> Exercise</h3>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Repeat what we did in class with Steve, but compare the <code>weekly</code> variable to a new variable call <code>conservative</code>.</p>
<p><a href="https://github.com/vaiseys/soc-stats-1/blob/main/demos/day-12.R" class="uri">https://github.com/vaiseys/soc-stats-1/blob/main/demos/day-12.R</a></p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Hint: You will have to create the <code>conservative</code> value yourself by modifying the <code>polviews variable.</code></p>
</div>
</div>
</div>
</section>
<section id="exercise-6" class="level3" data-number="6.2.3">
<h3 data-number="6.2.3" class="anchored" data-anchor-id="exercise-6"><span class="header-section-number">6.2.3</span> Exercise</h3>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Is the difference in proportions between <code>conservative</code> and <code>weekly</code> statistically significant?</p>
</div>
</div>
</div>
</section>
<section id="exercise-7" class="level3 page-columns page-full" data-number="6.2.4">
<h3 data-number="6.2.4" class="anchored" data-anchor-id="exercise-7"><span class="header-section-number">6.2.4</span> Exercise</h3>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Instead of discretizing the <code>polviews</code> and <code>attend</code> (which is what we did to create <code>weekly</code> and <code>conservative</code>), let’s try interpreting their original values.</p>
<p>I made the following plot using <code>geom_tile</code> to make the point that contingency tables are hard to interpret.</p>
<p>Try to describe what’s going on here.</p>
</div>
</div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="cell-output-display column-page">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="week06_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Hint: You can get the same values in this plot with the <code>tabyl()</code> function from the <code>janitor</code> package.</p>
</div>
</div>
</div>
</section>
<section id="bonus" class="level3" data-number="6.2.5">
<h3 data-number="6.2.5" class="anchored" data-anchor-id="bonus"><span class="header-section-number">6.2.5</span> Bonus</h3>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Do a Chi square test on <code>polviews</code> and <code>attend</code> using the <code>infer</code> package.</p>
<p>The null hypothesis is that these variables are “independent” of each other.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Hint: You may have to transform both <code>polviews</code> and <code>attend</code> into “factor” variables.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>d <span class="ot">&lt;-</span> d <span class="sc">|&gt;</span> </span>
<span id="cb41-2"><a href="#cb41-2"></a>  <span class="fu">mutate</span>(<span class="at">polviews =</span> <span class="fu">as_factor</span>(polviews),</span>
<span id="cb41-3"><a href="#cb41-3"></a>         <span class="at">attend =</span> <span class="fu">as_factor</span>(attend))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./week05.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Week 5</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./week07.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Week 7</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb42" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb42-1"><a href="#cb42-1"></a><span class="co">---</span></span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="an">title:</span><span class="co"> "Week 6"</span></span>
<span id="cb42-3"><a href="#cb42-3"></a><span class="an">callout-appearance:</span><span class="co"> simple</span></span>
<span id="cb42-4"><a href="#cb42-4"></a><span class="an">callout-icon:</span><span class="co"> false</span></span>
<span id="cb42-5"><a href="#cb42-5"></a><span class="co">---</span></span>
<span id="cb42-6"><a href="#cb42-6"></a></span>
<span id="cb42-7"><a href="#cb42-7"></a>The purpose of this week is to understand *null hypothesis significance testing* (NHST) and *confidence intervals.* We will be making use of **simulation-based statistical inference** (including permutation testing and bootstrapping).</span>
<span id="cb42-8"><a href="#cb42-8"></a></span>
<span id="cb42-9"><a href="#cb42-9"></a>These are some of the big ideas we will review:</span>
<span id="cb42-10"><a href="#cb42-10"></a></span>
<span id="cb42-11"><a href="#cb42-11"></a><span class="ss">-   </span>Sampling Distributions.</span>
<span id="cb42-12"><a href="#cb42-12"></a></span>
<span id="cb42-13"><a href="#cb42-13"></a><span class="ss">-   </span>Confidence Intervals.</span>
<span id="cb42-14"><a href="#cb42-14"></a></span>
<span id="cb42-15"><a href="#cb42-15"></a><span class="ss">-   </span>P-values and null-hypothesis testing.</span>
<span id="cb42-16"><a href="#cb42-16"></a></span>
<span id="cb42-17"><a href="#cb42-17"></a>And here are some of the applications we will review:</span>
<span id="cb42-18"><a href="#cb42-18"></a></span>
<span id="cb42-19"><a href="#cb42-19"></a><span class="ss">-   </span>Differences in proportions.</span>
<span id="cb42-20"><a href="#cb42-20"></a></span>
<span id="cb42-21"><a href="#cb42-21"></a><span class="ss">-   </span>Chi-square ( $\chi^2$ ) tests for independence.</span>
<span id="cb42-22"><a href="#cb42-22"></a></span>
<span id="cb42-23"><a href="#cb42-23"></a>**Set up**</span>
<span id="cb42-24"><a href="#cb42-24"></a></span>
<span id="cb42-25"><a href="#cb42-25"></a>Don't forget to put these lines at the beginning of your quarto document:</span>
<span id="cb42-26"><a href="#cb42-26"></a></span>
<span id="cb42-29"><a href="#cb42-29"></a><span class="in">```{r}</span></span>
<span id="cb42-30"><a href="#cb42-30"></a><span class="co">#| message: false</span></span>
<span id="cb42-31"><a href="#cb42-31"></a><span class="co">#| code-fold: false</span></span>
<span id="cb42-32"><a href="#cb42-32"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb42-33"><a href="#cb42-33"></a><span class="fu">library</span>(infer)</span>
<span id="cb42-34"><a href="#cb42-34"></a><span class="fu">library</span>(janitor) <span class="do">## for convenient "table" functions</span></span>
<span id="cb42-35"><a href="#cb42-35"></a><span class="fu">library</span>(gssr)    <span class="do">## for access to GSS data</span></span>
<span id="cb42-36"><a href="#cb42-36"></a></span>
<span id="cb42-37"><a href="#cb42-37"></a><span class="do">## You can choose another ggplot2 theme, obviously. </span></span>
<span id="cb42-38"><a href="#cb42-38"></a><span class="do">## Windows users might not have this font available!</span></span>
<span id="cb42-39"><a href="#cb42-39"></a><span class="fu">theme_set</span>(<span class="fu">theme_light</span>(<span class="at">base_family =</span> <span class="st">"Optima"</span>)) </span>
<span id="cb42-40"><a href="#cb42-40"></a><span class="in">```</span></span>
<span id="cb42-41"><a href="#cb42-41"></a></span>
<span id="cb42-42"><a href="#cb42-42"></a>*These are some useful readings:*</span>
<span id="cb42-43"><a href="#cb42-43"></a></span>
<span id="cb42-44"><a href="#cb42-44"></a><span class="ss">-   </span>"<span class="co">[</span><span class="ot">There is still only one test</span><span class="co">](http://allendowney.blogspot.com/2016/06/there-is-still-only-one-test.html)</span>" by Allen Downey</span>
<span id="cb42-45"><a href="#cb42-45"></a></span>
<span id="cb42-46"><a href="#cb42-46"></a><span class="ss">-   </span>The <span class="co">[</span><span class="ot">documentation</span><span class="co">](https://infer.netlify.app/)</span> for the <span class="in">`infer`</span> package is pretty good.</span>
<span id="cb42-47"><a href="#cb42-47"></a></span>
<span id="cb42-48"><a href="#cb42-48"></a><span class="ss">-   </span>The American Statistical Association's Statement on Statistical Significance and P-Values.</span>
<span id="cb42-49"><a href="#cb42-49"></a></span>
<span id="cb42-50"><a href="#cb42-50"></a>    <span class="ot">&lt;https://www.tandfonline.com/doi/epdf/10.1080/00031305.2016.1154108&gt;</span></span>
<span id="cb42-51"><a href="#cb42-51"></a></span>
<span id="cb42-52"><a href="#cb42-52"></a><span class="fu">## The *Truth* is Known</span></span>
<span id="cb42-53"><a href="#cb42-53"></a></span>
<span id="cb42-54"><a href="#cb42-54"></a><span class="fu">### Sampling Distributions</span></span>
<span id="cb42-55"><a href="#cb42-55"></a></span>
<span id="cb42-56"><a href="#cb42-56"></a>We have already seen sampling distributions in class.</span>
<span id="cb42-57"><a href="#cb42-57"></a></span>
<span id="cb42-58"><a href="#cb42-58"></a>For example, suppose we know that the true proportion of people voting Democrats is $0.53$. If we decide to poll $1000$ individuals, what can we say *beforehand* about the unobserved results?</span>
<span id="cb42-59"><a href="#cb42-59"></a></span>
<span id="cb42-60"><a href="#cb42-60"></a>The following chunk of code simulates this sampling distribution.</span>
<span id="cb42-61"><a href="#cb42-61"></a></span>
<span id="cb42-64"><a href="#cb42-64"></a><span class="in">```{r}</span></span>
<span id="cb42-65"><a href="#cb42-65"></a>S <span class="ot">&lt;-</span> <span class="fl">1e4</span> <span class="do">## number of simulated draws</span></span>
<span id="cb42-66"><a href="#cb42-66"></a>poll_size <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="do">## sample size</span></span>
<span id="cb42-67"><a href="#cb42-67"></a></span>
<span id="cb42-68"><a href="#cb42-68"></a>draws <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(S, <span class="at">size =</span> poll_size, <span class="at">prob =</span> <span class="fl">0.53</span>)</span>
<span id="cb42-69"><a href="#cb42-69"></a>proportions <span class="ot">&lt;-</span> draws <span class="sc">/</span> poll_size</span>
<span id="cb42-70"><a href="#cb42-70"></a></span>
<span id="cb42-71"><a href="#cb42-71"></a><span class="fu">tibble</span>(proportions) <span class="sc">|&gt;</span> </span>
<span id="cb42-72"><a href="#cb42-72"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(proportions)) <span class="sc">+</span> </span>
<span id="cb42-73"><a href="#cb42-73"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">boundary =</span> <span class="fl">0.5</span>, <span class="at">binwidth =</span> <span class="fl">0.005</span>) <span class="sc">+</span></span>
<span id="cb42-74"><a href="#cb42-74"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sampling Distribution of p = 0.53 and n = 1000"</span>)</span>
<span id="cb42-75"><a href="#cb42-75"></a><span class="in">```</span></span>
<span id="cb42-76"><a href="#cb42-76"></a></span>
<span id="cb42-77"><a href="#cb42-77"></a><span class="kw">&lt;aside&gt;</span>The **sampling distribution** is the set of possible sample "statistics" or "data summaries" (e.g., means, proportions) that could have been observed, *if the data collection process had been repeated many many times*.<span class="kw">&lt;/aside&gt;</span></span>
<span id="cb42-78"><a href="#cb42-78"></a></span>
<span id="cb42-79"><a href="#cb42-79"></a>This sampling distribution is centered around the *true value* of $0.53$.</span>
<span id="cb42-80"><a href="#cb42-80"></a></span>
<span id="cb42-83"><a href="#cb42-83"></a><span class="in">```{r}</span></span>
<span id="cb42-84"><a href="#cb42-84"></a><span class="fu">mean</span>(proportions)</span>
<span id="cb42-85"><a href="#cb42-85"></a><span class="in">```</span></span>
<span id="cb42-86"><a href="#cb42-86"></a></span>
<span id="cb42-87"><a href="#cb42-87"></a>The **standard error** is the standard deviation of the sample distribution.</span>
<span id="cb42-88"><a href="#cb42-88"></a></span>
<span id="cb42-91"><a href="#cb42-91"></a><span class="in">```{r}</span></span>
<span id="cb42-92"><a href="#cb42-92"></a>se <span class="ot">&lt;-</span> <span class="fu">sd</span>(proportions)</span>
<span id="cb42-93"><a href="#cb42-93"></a>se</span>
<span id="cb42-94"><a href="#cb42-94"></a><span class="in">```</span></span>
<span id="cb42-95"><a href="#cb42-95"></a></span>
<span id="cb42-96"><a href="#cb42-96"></a>Furthermore, this sampling distribution *looks* normal, which is something we come to expect because of the **Central Limit Theorem**.</span>
<span id="cb42-97"><a href="#cb42-97"></a></span>
<span id="cb42-98"><a href="#cb42-98"></a>In a normal distribution:</span>
<span id="cb42-99"><a href="#cb42-99"></a></span>
<span id="cb42-100"><a href="#cb42-100"></a><span class="ss">-   </span>We expect 68% of the values to be within 1 standard deviations around the center.</span>
<span id="cb42-101"><a href="#cb42-101"></a></span>
<span id="cb42-102"><a href="#cb42-102"></a>    <span class="in">```{r}</span></span>
<span id="cb42-103"><a href="#cb42-103"></a>    lower <span class="ot">&lt;-</span> <span class="fl">0.53</span> <span class="sc">-</span> <span class="dv">1</span><span class="sc">*</span>se</span>
<span id="cb42-104"><a href="#cb42-104"></a>    upper <span class="ot">&lt;-</span> <span class="fl">0.53</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span>se</span>
<span id="cb42-105"><a href="#cb42-105"></a>    <span class="fu">mean</span>(proportions <span class="sc">&gt;=</span> lower <span class="sc">&amp;</span> proportions <span class="sc">&lt;=</span> upper)</span>
<span id="cb42-106"><a href="#cb42-106"></a>    <span class="in">```</span></span>
<span id="cb42-107"><a href="#cb42-107"></a></span>
<span id="cb42-108"><a href="#cb42-108"></a><span class="ss">-   </span>We expect 95% of the values to be roughly within 2 standard deviations around the mean.</span>
<span id="cb42-109"><a href="#cb42-109"></a></span>
<span id="cb42-110"><a href="#cb42-110"></a>    <span class="in">```{r}</span></span>
<span id="cb42-111"><a href="#cb42-111"></a>    lower <span class="ot">&lt;-</span> <span class="fl">0.53</span> <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>se</span>
<span id="cb42-112"><a href="#cb42-112"></a>    upper <span class="ot">&lt;-</span> <span class="fl">0.53</span> <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>se</span>
<span id="cb42-113"><a href="#cb42-113"></a>    <span class="fu">mean</span>(<span class="fu">between</span>(proportions, lower, upper)) <span class="do">## using dplyr's between function</span></span>
<span id="cb42-114"><a href="#cb42-114"></a>    <span class="in">```</span></span>
<span id="cb42-115"><a href="#cb42-115"></a></span>
<span id="cb42-116"><a href="#cb42-116"></a>Now that we know this we can ask questions such as what is the probability that a poll of 1000 people tells us that the proportion of people voting Democrats is less than or equal to $0.5$?</span>
<span id="cb42-117"><a href="#cb42-117"></a></span>
<span id="cb42-120"><a href="#cb42-120"></a><span class="in">```{r}</span></span>
<span id="cb42-121"><a href="#cb42-121"></a><span class="fu">mean</span>(proportions <span class="sc">&lt;=</span> <span class="fl">0.5</span>)</span>
<span id="cb42-122"><a href="#cb42-122"></a><span class="in">```</span></span>
<span id="cb42-123"><a href="#cb42-123"></a></span>
<span id="cb42-124"><a href="#cb42-124"></a>So, the probability is very low. It seems that a poll of 1000 is very likely to declare the correct winner. Researchers do this kind of calculation all the time to make sure their sample size is sufficiently large for their purposes.</span>
<span id="cb42-125"><a href="#cb42-125"></a></span>
<span id="cb42-126"><a href="#cb42-126"></a>**Sampling distributions without simulations (aka using Math)**</span>
<span id="cb42-127"><a href="#cb42-127"></a></span>
<span id="cb42-128"><a href="#cb42-128"></a>Because of the CLT, we can construct some sampling distributions simply by calculating the center and the spread.</span>
<span id="cb42-129"><a href="#cb42-129"></a></span>
<span id="cb42-130"><a href="#cb42-130"></a>We know the center is $0.53$, and there's a convenient formula for calculating the standard error of a proportion:</span>
<span id="cb42-131"><a href="#cb42-131"></a></span>
<span id="cb42-132"><a href="#cb42-132"></a>$$</span>
<span id="cb42-133"><a href="#cb42-133"></a>\text{se}_p = \sqrt{\frac{p(1-p)}{n}} = \sqrt{\frac{0.53 \times 0.47}{1000}} \approx 0.01578</span>
<span id="cb42-134"><a href="#cb42-134"></a>$$</span>
<span id="cb42-135"><a href="#cb42-135"></a></span>
<span id="cb42-136"><a href="#cb42-136"></a><span class="kw">&lt;aside&gt;</span>Learning this formula is worth your time!<span class="kw">&lt;/aside&gt;</span></span>
<span id="cb42-137"><a href="#cb42-137"></a></span>
<span id="cb42-138"><a href="#cb42-138"></a>We can overlay this "analytical" sampling distribution on top of our simulated sampling distribution like this:</span>
<span id="cb42-139"><a href="#cb42-139"></a></span>
<span id="cb42-142"><a href="#cb42-142"></a><span class="in">```{r}</span></span>
<span id="cb42-143"><a href="#cb42-143"></a><span class="fu">tibble</span>(proportions) <span class="sc">|&gt;</span> </span>
<span id="cb42-144"><a href="#cb42-144"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(proportions)) <span class="sc">+</span> </span>
<span id="cb42-145"><a href="#cb42-145"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb42-146"><a href="#cb42-146"></a>    <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">boundary =</span> <span class="fl">0.5</span>, <span class="at">binwidth =</span> <span class="fl">0.005</span>,</span>
<span id="cb42-147"><a href="#cb42-147"></a>    <span class="do">## this is a little hack to ensure the y-axis are the same</span></span>
<span id="cb42-148"><a href="#cb42-148"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density))</span>
<span id="cb42-149"><a href="#cb42-149"></a>  ) <span class="sc">+</span></span>
<span id="cb42-150"><a href="#cb42-150"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sampling Distribution of p = 0.53 and n = 1000"</span>) <span class="sc">+</span></span>
<span id="cb42-151"><a href="#cb42-151"></a>  <span class="do">## adding the normal distribution on top</span></span>
<span id="cb42-152"><a href="#cb42-152"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> \(x) <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="fl">0.53</span>, <span class="at">sd =</span> se)) </span>
<span id="cb42-153"><a href="#cb42-153"></a>  </span>
<span id="cb42-154"><a href="#cb42-154"></a><span class="in">```</span></span>
<span id="cb42-155"><a href="#cb42-155"></a></span>
<span id="cb42-156"><a href="#cb42-156"></a><span class="kw">&lt;aside&gt;</span>Keep in mind that the output of <span class="in">`dnorm`</span> is labelled "density" whereas we had been calling output of <span class="in">`dbinom`</span> a "probability." That's because binomial distributions are *discrete,* whereas normal distributions as *continuous.* We can't really assign probabilities to continuous numbers because there are infinitely many of them and the math gets weird; thus, we think about them a little differently.<span class="kw">&lt;/aside&gt;</span></span>
<span id="cb42-157"><a href="#cb42-157"></a></span>
<span id="cb42-158"><a href="#cb42-158"></a>We can ask the same question as before: What is the probability that a poll of 1000 people tells us that the proportion of people voting Democrats is less than or equal to $0.5$? This probability is a *tail-area probability.* We call them like that because they correspond to that little shaded area under the curve.</span>
<span id="cb42-159"><a href="#cb42-159"></a></span>
<span id="cb42-160"><a href="#cb42-160"></a><span class="kw">&lt;aside&gt;</span>*P-values are also tail area probabilities!*<span class="kw">&lt;/aside&gt;</span></span>
<span id="cb42-161"><a href="#cb42-161"></a></span>
<span id="cb42-164"><a href="#cb42-164"></a><span class="in">```{r}</span></span>
<span id="cb42-165"><a href="#cb42-165"></a><span class="co">#| echo: false</span></span>
<span id="cb42-166"><a href="#cb42-166"></a><span class="co">#| fig-width: 5</span></span>
<span id="cb42-167"><a href="#cb42-167"></a><span class="co">#| fig-height: 3</span></span>
<span id="cb42-168"><a href="#cb42-168"></a><span class="co">#| fig-align: center</span></span>
<span id="cb42-169"><a href="#cb42-169"></a></span>
<span id="cb42-170"><a href="#cb42-170"></a><span class="fu">tibble</span>(proportions) <span class="sc">|&gt;</span> </span>
<span id="cb42-171"><a href="#cb42-171"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(proportions)) <span class="sc">+</span> </span>
<span id="cb42-172"><a href="#cb42-172"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb42-173"><a href="#cb42-173"></a>    <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">boundary =</span> <span class="fl">0.5</span>, <span class="at">binwidth =</span> <span class="fl">0.005</span>,</span>
<span id="cb42-174"><a href="#cb42-174"></a>    <span class="do">## this is a little hack to ensure the y-axis are the same</span></span>
<span id="cb42-175"><a href="#cb42-175"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density))</span>
<span id="cb42-176"><a href="#cb42-176"></a>  ) <span class="sc">+</span></span>
<span id="cb42-177"><a href="#cb42-177"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sampling Distribution of p = 0.53 and n = 1000"</span>) <span class="sc">+</span></span>
<span id="cb42-178"><a href="#cb42-178"></a>  <span class="do">## adding the normal distribution on top</span></span>
<span id="cb42-179"><a href="#cb42-179"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> \(x) <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="fl">0.53</span>, <span class="at">sd =</span> se)) <span class="sc">+</span></span>
<span id="cb42-180"><a href="#cb42-180"></a>  <span class="fu">stat_function</span>(</span>
<span id="cb42-181"><a href="#cb42-181"></a>    <span class="at">geom =</span> <span class="st">"area"</span>, </span>
<span id="cb42-182"><a href="#cb42-182"></a>    <span class="at">fun =</span> \(x) <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="fl">0.53</span>, <span class="at">sd =</span> se), </span>
<span id="cb42-183"><a href="#cb42-183"></a>    <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.45</span>, <span class="fl">0.5</span>),</span>
<span id="cb42-184"><a href="#cb42-184"></a>    <span class="at">fill =</span> <span class="st">"pink"</span></span>
<span id="cb42-185"><a href="#cb42-185"></a>  ) <span class="sc">+</span></span>
<span id="cb42-186"><a href="#cb42-186"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb42-187"><a href="#cb42-187"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"density"</span>, <span class="at">x =</span> <span class="st">"proportions"</span>)</span>
<span id="cb42-188"><a href="#cb42-188"></a><span class="in">```</span></span>
<span id="cb42-189"><a href="#cb42-189"></a></span>
<span id="cb42-192"><a href="#cb42-192"></a><span class="in">```{r}</span></span>
<span id="cb42-193"><a href="#cb42-193"></a><span class="fu">pnorm</span>(<span class="fl">0.5</span>, <span class="at">mean =</span> <span class="fl">0.53</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="fl">0.53</span><span class="sc">*</span><span class="fl">0.47</span><span class="sc">/</span><span class="dv">1000</span>))</span>
<span id="cb42-194"><a href="#cb42-194"></a><span class="in">```</span></span>
<span id="cb42-195"><a href="#cb42-195"></a></span>
<span id="cb42-196"><a href="#cb42-196"></a><span class="fu">### Exercise</span></span>
<span id="cb42-197"><a href="#cb42-197"></a></span>
<span id="cb42-198"><a href="#cb42-198"></a>::: callout-note</span>
<span id="cb42-199"><a href="#cb42-199"></a>*Choosing sample size.*</span>
<span id="cb42-200"><a href="#cb42-200"></a></span>
<span id="cb42-201"><a href="#cb42-201"></a>You are designing a survey to estimate the proportion of individuals who will vote Democrat. Assuming that respondents are a simple random sample of the voting population, how many people do you need to poll so that the standard error is less than 5 percentage points?</span>
<span id="cb42-202"><a href="#cb42-202"></a>:::</span>
<span id="cb42-203"><a href="#cb42-203"></a></span>
<span id="cb42-204"><a href="#cb42-204"></a><span class="fu">### Confidence Intervals</span></span>
<span id="cb42-205"><a href="#cb42-205"></a></span>
<span id="cb42-206"><a href="#cb42-206"></a>Confidence intervals are constructed from the data we get to observe. In the example above, we established that the true population parameter was equal to $0.53$ and that the sample size was equal to $1000$.</span>
<span id="cb42-207"><a href="#cb42-207"></a></span>
<span id="cb42-208"><a href="#cb42-208"></a>This is how one dataset could look like:</span>
<span id="cb42-209"><a href="#cb42-209"></a></span>
<span id="cb42-212"><a href="#cb42-212"></a><span class="in">```{r}</span></span>
<span id="cb42-213"><a href="#cb42-213"></a><span class="fu">set.seed</span>(<span class="dv">321</span>)</span>
<span id="cb42-214"><a href="#cb42-214"></a>one_dataset <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(poll_size, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.53</span>)</span>
<span id="cb42-215"><a href="#cb42-215"></a><span class="fu">glimpse</span>(one_dataset) <span class="do">## one thousand observations of 1s and 0s</span></span>
<span id="cb42-216"><a href="#cb42-216"></a><span class="in">```</span></span>
<span id="cb42-217"><a href="#cb42-217"></a></span>
<span id="cb42-218"><a href="#cb42-218"></a>The *estimated* proportion from this one dataset is calculated as follows:</span>
<span id="cb42-219"><a href="#cb42-219"></a></span>
<span id="cb42-222"><a href="#cb42-222"></a><span class="in">```{r}</span></span>
<span id="cb42-223"><a href="#cb42-223"></a>prop_hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(one_dataset)</span>
<span id="cb42-224"><a href="#cb42-224"></a>prop_hat</span>
<span id="cb42-225"><a href="#cb42-225"></a><span class="in">```</span></span>
<span id="cb42-226"><a href="#cb42-226"></a></span>
<span id="cb42-227"><a href="#cb42-227"></a>It's increasingly common practice to *estimate* standard errors using a computational approximation technique called the **bootstrap**.</span>
<span id="cb42-228"><a href="#cb42-228"></a></span>
<span id="cb42-229"><a href="#cb42-229"></a>Bootstrap resampling is done *with replacement*; that is, the same data point can appear multiple times in a resampled dataset. This is necessary, as otherwise it would not be possible to get new datasets of the same size as the original.</span>
<span id="cb42-230"><a href="#cb42-230"></a></span>
<span id="cb42-231"><a href="#cb42-231"></a>The following chunk of code estimates 10,000 resampled proportions.</span>
<span id="cb42-232"><a href="#cb42-232"></a></span>
<span id="cb42-235"><a href="#cb42-235"></a><span class="in">```{r}</span></span>
<span id="cb42-236"><a href="#cb42-236"></a>boot_stats <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="fl">1e4</span>, {</span>
<span id="cb42-237"><a href="#cb42-237"></a>  resample <span class="ot">&lt;-</span> <span class="fu">sample</span>(one_dataset, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-238"><a href="#cb42-238"></a>  <span class="fu">mean</span>(resample)</span>
<span id="cb42-239"><a href="#cb42-239"></a>})</span>
<span id="cb42-240"><a href="#cb42-240"></a></span>
<span id="cb42-241"><a href="#cb42-241"></a><span class="fu">glimpse</span>(boot_stats)</span>
<span id="cb42-242"><a href="#cb42-242"></a><span class="in">```</span></span>
<span id="cb42-243"><a href="#cb42-243"></a></span>
<span id="cb42-244"><a href="#cb42-244"></a>We can then construct a confidence interval using the <span class="in">`quantile()`</span> function on the bootstrap statistics.</span>
<span id="cb42-245"><a href="#cb42-245"></a></span>
<span id="cb42-248"><a href="#cb42-248"></a><span class="in">```{r}</span></span>
<span id="cb42-249"><a href="#cb42-249"></a>ci95 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(boot_stats, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb42-250"><a href="#cb42-250"></a>ci95</span>
<span id="cb42-251"><a href="#cb42-251"></a><span class="in">```</span></span>
<span id="cb42-252"><a href="#cb42-252"></a></span>
<span id="cb42-253"><a href="#cb42-253"></a>This is how the bootstrap proportions---and the 95% confidence interval---compare to the "true" sampling distribution:</span>
<span id="cb42-254"><a href="#cb42-254"></a></span>
<span id="cb42-257"><a href="#cb42-257"></a><span class="in">```{r}</span></span>
<span id="cb42-258"><a href="#cb42-258"></a><span class="co">#| warning: false</span></span>
<span id="cb42-259"><a href="#cb42-259"></a><span class="co">#| code-fold: true</span></span>
<span id="cb42-260"><a href="#cb42-260"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb42-261"><a href="#cb42-261"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb42-262"><a href="#cb42-262"></a>    <span class="at">data =</span> <span class="fu">tibble</span>(proportions),</span>
<span id="cb42-263"><a href="#cb42-263"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(proportions, <span class="at">fill =</span> <span class="st">"sampling distribution"</span>),</span>
<span id="cb42-264"><a href="#cb42-264"></a>    <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb42-265"><a href="#cb42-265"></a>    <span class="at">boundary =</span> <span class="fl">0.5</span>,</span>
<span id="cb42-266"><a href="#cb42-266"></a>    <span class="at">binwidth =</span> <span class="fl">0.005</span></span>
<span id="cb42-267"><a href="#cb42-267"></a>  ) <span class="sc">+</span> </span>
<span id="cb42-268"><a href="#cb42-268"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb42-269"><a href="#cb42-269"></a>    <span class="at">data =</span> <span class="fu">tibble</span>(boot_stats),</span>
<span id="cb42-270"><a href="#cb42-270"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(boot_stats, <span class="at">fill =</span> <span class="st">"bootstrap proportions"</span>),</span>
<span id="cb42-271"><a href="#cb42-271"></a>    <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb42-272"><a href="#cb42-272"></a>    <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, </span>
<span id="cb42-273"><a href="#cb42-273"></a>    <span class="at">boundary =</span> <span class="fl">0.5</span>,</span>
<span id="cb42-274"><a href="#cb42-274"></a>    <span class="at">binwidth =</span> <span class="fl">0.005</span></span>
<span id="cb42-275"><a href="#cb42-275"></a>  ) <span class="sc">+</span></span>
<span id="cb42-276"><a href="#cb42-276"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> ci95, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb42-277"><a href="#cb42-277"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="cn">NULL</span>, <span class="at">title =</span> <span class="st">"95% Confidence Interval"</span>, <span class="at">y =</span> <span class="st">"count"</span>) <span class="sc">+</span></span>
<span id="cb42-278"><a href="#cb42-278"></a>  <span class="fu">annotate</span>(</span>
<span id="cb42-279"><a href="#cb42-279"></a>    <span class="st">"text"</span>, <span class="at">x =</span> prop_hat, <span class="at">y =</span> <span class="dv">500</span>, <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb42-280"><a href="#cb42-280"></a>    <span class="do">## hack for LaTeX expressions in graphs</span></span>
<span id="cb42-281"><a href="#cb42-281"></a>    <span class="at">label =</span> latex2exp<span class="sc">::</span><span class="fu">TeX</span>(<span class="fu">paste</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">hat{p} ="</span>, prop_hat))</span>
<span id="cb42-282"><a href="#cb42-282"></a>  )</span>
<span id="cb42-283"><a href="#cb42-283"></a><span class="in">```</span></span>
<span id="cb42-284"><a href="#cb42-284"></a></span>
<span id="cb42-285"><a href="#cb42-285"></a>**Confidence intervals without simulations (aka using Math)**</span>
<span id="cb42-286"><a href="#cb42-286"></a></span>
<span id="cb42-287"><a href="#cb42-287"></a>We can also *estimate* standard errors "analytically" using the following formula:</span>
<span id="cb42-288"><a href="#cb42-288"></a></span>
<span id="cb42-289"><a href="#cb42-289"></a>$$</span>
<span id="cb42-290"><a href="#cb42-290"></a>\widehat{\text{se}_p} = \sqrt{\frac{\hat{p}(1-\hat{p})}{n}}</span>
<span id="cb42-291"><a href="#cb42-291"></a>$$</span>
<span id="cb42-292"><a href="#cb42-292"></a></span>
<span id="cb42-293"><a href="#cb42-293"></a><span class="kw">&lt;aside&gt;</span>Note the use of the "hat" symbol in $\hat p$ to indicate that these are *estimates* from a dataset.<span class="kw">&lt;/aside&gt;</span></span>
<span id="cb42-294"><a href="#cb42-294"></a></span>
<span id="cb42-297"><a href="#cb42-297"></a><span class="in">```{r}</span></span>
<span id="cb42-298"><a href="#cb42-298"></a>se_hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(prop_hat <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> prop_hat) <span class="sc">/</span> <span class="dv">1000</span>)</span>
<span id="cb42-299"><a href="#cb42-299"></a>se_hat</span>
<span id="cb42-300"><a href="#cb42-300"></a><span class="in">```</span></span>
<span id="cb42-301"><a href="#cb42-301"></a></span>
<span id="cb42-302"><a href="#cb42-302"></a>Assuming that the normal distribution kicks in because of the CLT, we can estimate the 95% confidence interval using the <span class="in">`qnorm()`</span> function:</span>
<span id="cb42-303"><a href="#cb42-303"></a></span>
<span id="cb42-306"><a href="#cb42-306"></a><span class="in">```{r}</span></span>
<span id="cb42-307"><a href="#cb42-307"></a><span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), <span class="at">mean =</span> prop_hat, <span class="at">sd =</span> se_hat)</span>
<span id="cb42-308"><a href="#cb42-308"></a><span class="in">```</span></span>
<span id="cb42-309"><a href="#cb42-309"></a></span>
<span id="cb42-310"><a href="#cb42-310"></a>In this case, *both confidence intervals are identical.* But we did have to make more assumptions (e.g., using a normal distribution)! And we also had to use formulas that we might not understand (e.g., the formula for $\widehat{\text{se}_p}$ )!</span>
<span id="cb42-311"><a href="#cb42-311"></a></span>
<span id="cb42-314"><a href="#cb42-314"></a><span class="in">```{r}</span></span>
<span id="cb42-315"><a href="#cb42-315"></a><span class="co">#| code-fold: true</span></span>
<span id="cb42-316"><a href="#cb42-316"></a></span>
<span id="cb42-317"><a href="#cb42-317"></a>prop_hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(one_dataset)</span>
<span id="cb42-318"><a href="#cb42-318"></a>se_hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(prop_hat <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> prop_hat) <span class="sc">/</span> <span class="dv">1000</span>)</span>
<span id="cb42-319"><a href="#cb42-319"></a>ci95 <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), <span class="at">mean =</span> prop_hat, <span class="at">sd =</span> se_hat)</span>
<span id="cb42-320"><a href="#cb42-320"></a></span>
<span id="cb42-321"><a href="#cb42-321"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb42-322"><a href="#cb42-322"></a>  <span class="fu">stat_function</span>(</span>
<span id="cb42-323"><a href="#cb42-323"></a>    <span class="at">geom =</span> <span class="st">"area"</span>,</span>
<span id="cb42-324"><a href="#cb42-324"></a>    <span class="at">fun =</span> \(x) <span class="fu">dnorm</span>(x, <span class="fl">0.53</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="fl">0.53</span><span class="sc">*</span><span class="fl">0.47</span><span class="sc">/</span><span class="dv">1000</span>)),</span>
<span id="cb42-325"><a href="#cb42-325"></a>    <span class="at">fill =</span> <span class="st">"steelblue1"</span></span>
<span id="cb42-326"><a href="#cb42-326"></a>  ) <span class="sc">+</span></span>
<span id="cb42-327"><a href="#cb42-327"></a>  <span class="fu">stat_function</span>(</span>
<span id="cb42-328"><a href="#cb42-328"></a>    <span class="at">geom =</span> <span class="st">"area"</span>,</span>
<span id="cb42-329"><a href="#cb42-329"></a>    <span class="at">fun =</span> \(x) <span class="fu">dnorm</span>(x, prop_hat, se_hat),</span>
<span id="cb42-330"><a href="#cb42-330"></a>    <span class="at">fill =</span> <span class="st">"pink"</span>, <span class="at">alpha =</span> <span class="dv">4</span><span class="sc">/</span><span class="dv">5</span></span>
<span id="cb42-331"><a href="#cb42-331"></a>  ) <span class="sc">+</span> </span>
<span id="cb42-332"><a href="#cb42-332"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> ci95, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb42-333"><a href="#cb42-333"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.43</span>, <span class="fl">0.6</span>, <span class="fl">0.02</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.43</span>, <span class="fl">0.6</span>)) <span class="sc">+</span></span>
<span id="cb42-334"><a href="#cb42-334"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"proportions"</span>, <span class="at">y =</span> <span class="st">"density"</span>, <span class="at">title =</span> <span class="st">"95% Confidence Interval"</span>)</span>
<span id="cb42-335"><a href="#cb42-335"></a><span class="in">```</span></span>
<span id="cb42-336"><a href="#cb42-336"></a></span>
<span id="cb42-337"><a href="#cb42-337"></a><span class="fu">### NHST</span></span>
<span id="cb42-338"><a href="#cb42-338"></a></span>
<span id="cb42-339"><a href="#cb42-339"></a>Null Hypothesis Statistical Testing also involves the construction of sampling distributions---i.e., we first construct the sampling distribution of the "null model."</span>
<span id="cb42-340"><a href="#cb42-340"></a></span>
<span id="cb42-341"><a href="#cb42-341"></a>This procedure can be quite mechanical:</span>
<span id="cb42-342"><a href="#cb42-342"></a></span>
<span id="cb42-343"><a href="#cb42-343"></a><span class="ss">1.  </span>We assume a hypothesis we would like to refute: a *null hypothesis* often denoted as $H_0$.</span>
<span id="cb42-344"><a href="#cb42-344"></a></span>
<span id="cb42-345"><a href="#cb42-345"></a><span class="ss">2.  </span>We choose a *test statistic* (e.g., an average, a proportion), which is some function of the observed data.</span>
<span id="cb42-346"><a href="#cb42-346"></a></span>
<span id="cb42-347"><a href="#cb42-347"></a><span class="ss">3.  </span>We derive the *sampling distribution* of the test statistic, given the null hypothesis. This distribution is also called the *reference distribution*.</span>
<span id="cb42-348"><a href="#cb42-348"></a></span>
<span id="cb42-349"><a href="#cb42-349"></a><span class="ss">4.  </span>We ask whether the observed value of the test statistic is likely to occur under the reference distribution. This probability is also known as a $p$*-value*.</span>
<span id="cb42-350"><a href="#cb42-350"></a></span>
<span id="cb42-351"><a href="#cb42-351"></a>    The $p$-value is the probability that, under the null hypothesis, we observe a value of the test statistic at least as extreme as the one we actually observed.</span>
<span id="cb42-352"><a href="#cb42-352"></a></span>
<span id="cb42-353"><a href="#cb42-353"></a><span class="ss">5.  </span>We reject the null hypothesis if the $p$-value is less than or equal to the confidence level $\alpha$. Otherwise, we retain the null hypothesis (i.e., we *fail to reject* the null hypothesis).</span>
<span id="cb42-354"><a href="#cb42-354"></a></span>
<span id="cb42-355"><a href="#cb42-355"></a>For example, continuing the previous example, suppose that our null model ( $H_0$ ) is that the proportion of people who vote Democrat and Republican is the same---i.e., that $p = 0.5$.</span>
<span id="cb42-356"><a href="#cb42-356"></a></span>
<span id="cb42-357"><a href="#cb42-357"></a>We can simulate the null distribution as follows:</span>
<span id="cb42-358"><a href="#cb42-358"></a></span>
<span id="cb42-361"><a href="#cb42-361"></a><span class="in">```{r}</span></span>
<span id="cb42-362"><a href="#cb42-362"></a>S <span class="ot">&lt;-</span> <span class="fl">1e4</span> <span class="do">## number of simulated draws</span></span>
<span id="cb42-363"><a href="#cb42-363"></a>poll_size <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="do">## sample size</span></span>
<span id="cb42-364"><a href="#cb42-364"></a></span>
<span id="cb42-365"><a href="#cb42-365"></a>draws <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(S, <span class="at">size =</span> poll_size, <span class="at">prob =</span> <span class="fl">0.50</span>)</span>
<span id="cb42-366"><a href="#cb42-366"></a>null <span class="ot">&lt;-</span> draws <span class="sc">/</span> poll_size</span>
<span id="cb42-367"><a href="#cb42-367"></a><span class="in">```</span></span>
<span id="cb42-368"><a href="#cb42-368"></a></span>
<span id="cb42-369"><a href="#cb42-369"></a><span class="kw">&lt;aside&gt;</span>This is almost the exact same code that we used before. Only the <span class="in">`prob`</span> argument has changed.<span class="kw">&lt;/aside&gt;</span></span>
<span id="cb42-370"><a href="#cb42-370"></a></span>
<span id="cb42-371"><a href="#cb42-371"></a>We can overlay the null distribution on top of the sampling distribution for the "true" parameter as follows:</span>
<span id="cb42-372"><a href="#cb42-372"></a></span>
<span id="cb42-375"><a href="#cb42-375"></a><span class="in">```{r}</span></span>
<span id="cb42-376"><a href="#cb42-376"></a><span class="co">#| warning: false</span></span>
<span id="cb42-377"><a href="#cb42-377"></a><span class="co">#| fig-width: 9</span></span>
<span id="cb42-378"><a href="#cb42-378"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb42-379"><a href="#cb42-379"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb42-380"><a href="#cb42-380"></a>    <span class="at">data =</span> <span class="fu">tibble</span>(proportions),</span>
<span id="cb42-381"><a href="#cb42-381"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(proportions, <span class="at">fill =</span> <span class="st">"True Sampling Distribution"</span>),</span>
<span id="cb42-382"><a href="#cb42-382"></a>    <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">boundary =</span> <span class="fl">0.5</span>, <span class="at">binwidth =</span> <span class="fl">0.005</span>,</span>
<span id="cb42-383"><a href="#cb42-383"></a>  ) <span class="sc">+</span></span>
<span id="cb42-384"><a href="#cb42-384"></a>  <span class="fu">geom_histogram</span>(</span>
<span id="cb42-385"><a href="#cb42-385"></a>    <span class="at">data =</span> <span class="fu">tibble</span>(null),</span>
<span id="cb42-386"><a href="#cb42-386"></a>    <span class="at">mapping =</span> <span class="fu">aes</span>(null, <span class="at">fill =</span> <span class="st">"Null Sampling Distribution"</span>),</span>
<span id="cb42-387"><a href="#cb42-387"></a>    <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">boundary =</span> <span class="fl">0.5</span>, <span class="at">binwidth =</span> <span class="fl">0.005</span>,</span>
<span id="cb42-388"><a href="#cb42-388"></a>    <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span></span>
<span id="cb42-389"><a href="#cb42-389"></a>  ) <span class="sc">+</span></span>
<span id="cb42-390"><a href="#cb42-390"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.43</span>, <span class="fl">0.61</span>, <span class="fl">0.02</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.43</span>, <span class="fl">0.61</span>)) <span class="sc">+</span></span>
<span id="cb42-391"><a href="#cb42-391"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="cn">NULL</span>)</span>
<span id="cb42-392"><a href="#cb42-392"></a><span class="in">```</span></span>
<span id="cb42-393"><a href="#cb42-393"></a></span>
<span id="cb42-394"><a href="#cb42-394"></a><span class="fu">### Exercise</span></span>
<span id="cb42-395"><a href="#cb42-395"></a></span>
<span id="cb42-396"><a href="#cb42-396"></a>::: callout-note</span>
<span id="cb42-397"><a href="#cb42-397"></a>What is the probability of observing the "true" value ( $p = 0.53$ ) under the null?</span>
<span id="cb42-398"><a href="#cb42-398"></a></span>
<span id="cb42-399"><a href="#cb42-399"></a>What is the probability of observing <span class="in">`prop_hat`</span> under the null? Is this statistically significant if the confidence level ( $\alpha$ ) is set to 0.05?</span>
<span id="cb42-400"><a href="#cb42-400"></a>:::</span>
<span id="cb42-401"><a href="#cb42-401"></a></span>
<span id="cb42-402"><a href="#cb42-402"></a>::: callout-tip</span>
<span id="cb42-403"><a href="#cb42-403"></a>Hint: As a reminder, this is how I calculated <span class="in">`prop_hat`</span> earlier:</span>
<span id="cb42-404"><a href="#cb42-404"></a></span>
<span id="cb42-407"><a href="#cb42-407"></a><span class="in">```{r}</span></span>
<span id="cb42-408"><a href="#cb42-408"></a><span class="co">#| eval: false</span></span>
<span id="cb42-409"><a href="#cb42-409"></a><span class="fu">set.seed</span>(<span class="dv">321</span>)</span>
<span id="cb42-410"><a href="#cb42-410"></a>one_dataset <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(poll_size, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.53</span>)</span>
<span id="cb42-411"><a href="#cb42-411"></a>prop_hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(one_dataset)</span>
<span id="cb42-412"><a href="#cb42-412"></a><span class="in">```</span></span>
<span id="cb42-413"><a href="#cb42-413"></a></span>
<span id="cb42-414"><a href="#cb42-414"></a>Here, <span class="in">`prop_hat`</span> is 0.513. If you remove the <span class="in">`set.seed(321)`</span> line you will get a different value of <span class="in">`prop_hat`</span>. I encourage you to play around with this.</span>
<span id="cb42-415"><a href="#cb42-415"></a>:::</span>
<span id="cb42-416"><a href="#cb42-416"></a></span>
<span id="cb42-417"><a href="#cb42-417"></a>::: callout-tip</span>
<span id="cb42-418"><a href="#cb42-418"></a>Hint: You can reach the same decision with NHST and confidence intervals. If your $H_0$ is included within the confidence interval, we then fail to reject the null.</span>
<span id="cb42-419"><a href="#cb42-419"></a>:::</span>
<span id="cb42-420"><a href="#cb42-420"></a></span>
<span id="cb42-421"><a href="#cb42-421"></a><span class="fu">### Difference in Proportions</span></span>
<span id="cb42-422"><a href="#cb42-422"></a></span>
<span id="cb42-423"><a href="#cb42-423"></a>We can repeat everything we did before for other scenarios; for example, a difference in proportions.</span>
<span id="cb42-424"><a href="#cb42-424"></a></span>
<span id="cb42-425"><a href="#cb42-425"></a>Suppose we have to groups of people (e.g., men and women) who differ in the proportion of voting Democrat.</span>
<span id="cb42-426"><a href="#cb42-426"></a></span>
<span id="cb42-427"><a href="#cb42-427"></a>For example, we can assume that $p_1 = 0.5$ and that $p_2 = 0.6$.</span>
<span id="cb42-428"><a href="#cb42-428"></a></span>
<span id="cb42-429"><a href="#cb42-429"></a>Here, the *true* difference in proportions is $\theta = p_1 - p_2 = -0.1$.</span>
<span id="cb42-430"><a href="#cb42-430"></a></span>
<span id="cb42-431"><a href="#cb42-431"></a>The following chunk creates a sampling distribution for this new parameter $\theta$.</span>
<span id="cb42-432"><a href="#cb42-432"></a></span>
<span id="cb42-435"><a href="#cb42-435"></a><span class="in">```{r}</span></span>
<span id="cb42-436"><a href="#cb42-436"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb42-437"><a href="#cb42-437"></a>n1 <span class="ot">&lt;-</span> <span class="dv">120</span></span>
<span id="cb42-438"><a href="#cb42-438"></a>p2 <span class="ot">&lt;-</span> <span class="fl">0.6</span></span>
<span id="cb42-439"><a href="#cb42-439"></a>n2 <span class="ot">&lt;-</span> <span class="dv">90</span></span>
<span id="cb42-440"><a href="#cb42-440"></a></span>
<span id="cb42-441"><a href="#cb42-441"></a>S <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb42-442"><a href="#cb42-442"></a>draws1 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(S, <span class="at">size =</span> n1, <span class="at">prob =</span> p1) </span>
<span id="cb42-443"><a href="#cb42-443"></a>proportions1 <span class="ot">&lt;-</span> draws1 <span class="sc">/</span> n1 </span>
<span id="cb42-444"><a href="#cb42-444"></a>draws2 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(S, <span class="at">size =</span> n2, <span class="at">prob =</span> p2)</span>
<span id="cb42-445"><a href="#cb42-445"></a>proportions2 <span class="ot">&lt;-</span> draws2 <span class="sc">/</span> n2</span>
<span id="cb42-446"><a href="#cb42-446"></a>theta_distribution <span class="ot">&lt;-</span> proportions1 <span class="sc">-</span> proportions2</span>
<span id="cb42-447"><a href="#cb42-447"></a><span class="in">```</span></span>
<span id="cb42-448"><a href="#cb42-448"></a></span>
<span id="cb42-449"><a href="#cb42-449"></a>As before, the sampling distribution is centered around the true value of $-0.1$</span>
<span id="cb42-450"><a href="#cb42-450"></a></span>
<span id="cb42-453"><a href="#cb42-453"></a><span class="in">```{r}</span></span>
<span id="cb42-454"><a href="#cb42-454"></a><span class="fu">mean</span>(theta_distribution)</span>
<span id="cb42-455"><a href="#cb42-455"></a><span class="in">```</span></span>
<span id="cb42-456"><a href="#cb42-456"></a></span>
<span id="cb42-457"><a href="#cb42-457"></a>And the standard error is given by:</span>
<span id="cb42-458"><a href="#cb42-458"></a></span>
<span id="cb42-461"><a href="#cb42-461"></a><span class="in">```{r}</span></span>
<span id="cb42-462"><a href="#cb42-462"></a><span class="fu">sd</span>(theta_distribution)</span>
<span id="cb42-463"><a href="#cb42-463"></a><span class="in">```</span></span>
<span id="cb42-464"><a href="#cb42-464"></a></span>
<span id="cb42-467"><a href="#cb42-467"></a><span class="in">```{r}</span></span>
<span id="cb42-468"><a href="#cb42-468"></a><span class="fu">tibble</span>(<span class="at">theta =</span> theta_distribution) <span class="sc">|&gt;</span> </span>
<span id="cb42-469"><a href="#cb42-469"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(theta)) <span class="sc">+</span> </span>
<span id="cb42-470"><a href="#cb42-470"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">boundary =</span> <span class="fl">0.5</span>, <span class="at">binwidth =</span> <span class="fl">0.025</span>) <span class="sc">+</span></span>
<span id="cb42-471"><a href="#cb42-471"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sampling Distribution of differences in proportions"</span>)</span>
<span id="cb42-472"><a href="#cb42-472"></a><span class="in">```</span></span>
<span id="cb42-473"><a href="#cb42-473"></a></span>
<span id="cb42-474"><a href="#cb42-474"></a><span class="fu">### Exercise</span></span>
<span id="cb42-475"><a href="#cb42-475"></a></span>
<span id="cb42-476"><a href="#cb42-476"></a>::: callout-note</span>
<span id="cb42-477"><a href="#cb42-477"></a>The formula for calculating the standard error of a difference in proportions is given by:</span>
<span id="cb42-478"><a href="#cb42-478"></a></span>
<span id="cb42-479"><a href="#cb42-479"></a>$$</span>
<span id="cb42-480"><a href="#cb42-480"></a>\sigma_{\hat p_1 - \hat p_2} = \sqrt{\frac{p_1 (1 - p_1)}{n_1} + \frac{p_2 (1 - p_2)}{n_2}}</span>
<span id="cb42-481"><a href="#cb42-481"></a>$$</span>
<span id="cb42-482"><a href="#cb42-482"></a></span>
<span id="cb42-483"><a href="#cb42-483"></a>Verify that this standard error corresponds to <span class="in">`sd(theta_distribution)`</span>.</span>
<span id="cb42-484"><a href="#cb42-484"></a>:::</span>
<span id="cb42-485"><a href="#cb42-485"></a></span>
<span id="cb42-486"><a href="#cb42-486"></a><span class="fu">### Exercise</span></span>
<span id="cb42-487"><a href="#cb42-487"></a></span>
<span id="cb42-488"><a href="#cb42-488"></a>::: callout-note</span>
<span id="cb42-489"><a href="#cb42-489"></a>*Comparison of proportions.*</span>
<span id="cb42-490"><a href="#cb42-490"></a></span>
<span id="cb42-491"><a href="#cb42-491"></a>A randomized experiment is performed within a survey. 1000 people are contacted. Half the people contacted are promised a \$5 incentive to participate, and half are not promised an incentive. The result is a 50% response rate among the treated group and 40% response rate among the control group. Give an estimate and standard error of the difference in proportions.</span>
<span id="cb42-492"><a href="#cb42-492"></a>:::</span>
<span id="cb42-493"><a href="#cb42-493"></a></span>
<span id="cb42-494"><a href="#cb42-494"></a>::: callout-tip</span>
<span id="cb42-495"><a href="#cb42-495"></a>Hint: Because this is a randomized experiment, we usually refer to this difference in proportions as an *average treatment effect,* which we interpret as a causal effect.</span>
<span id="cb42-496"><a href="#cb42-496"></a>:::</span>
<span id="cb42-497"><a href="#cb42-497"></a></span>
<span id="cb42-498"><a href="#cb42-498"></a><span class="fu">## The *Data* is Known</span></span>
<span id="cb42-499"><a href="#cb42-499"></a></span>
<span id="cb42-500"><a href="#cb42-500"></a>Here we will work with GSS data.</span>
<span id="cb42-501"><a href="#cb42-501"></a></span>
<span id="cb42-502"><a href="#cb42-502"></a>Copy the following chunk of code to get the data frame we will be using.</span>
<span id="cb42-503"><a href="#cb42-503"></a></span>
<span id="cb42-506"><a href="#cb42-506"></a><span class="in">```{r}</span></span>
<span id="cb42-507"><a href="#cb42-507"></a><span class="co">#| message: false</span></span>
<span id="cb42-508"><a href="#cb42-508"></a>gss18 <span class="ot">&lt;-</span> <span class="fu">gss_get_yr</span>(<span class="dv">2018</span>) </span>
<span id="cb42-509"><a href="#cb42-509"></a></span>
<span id="cb42-510"><a href="#cb42-510"></a>d <span class="ot">&lt;-</span> gss18 <span class="sc">|&gt;</span> </span>
<span id="cb42-511"><a href="#cb42-511"></a>  <span class="fu">select</span>(sex, attend, polviews) <span class="sc">|&gt;</span> </span>
<span id="cb42-512"><a href="#cb42-512"></a>  haven<span class="sc">::</span><span class="fu">zap_missing</span>() <span class="sc">|&gt;</span> </span>
<span id="cb42-513"><a href="#cb42-513"></a>  <span class="fu">mutate</span>(<span class="at">sex =</span> <span class="fu">as_factor</span>(sex)) <span class="sc">|&gt;</span> </span>
<span id="cb42-514"><a href="#cb42-514"></a>  haven<span class="sc">::</span><span class="fu">zap_labels</span>() <span class="sc">|&gt;</span> </span>
<span id="cb42-515"><a href="#cb42-515"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb42-516"><a href="#cb42-516"></a></span>
<span id="cb42-517"><a href="#cb42-517"></a><span class="fu">glimpse</span>(d)</span>
<span id="cb42-518"><a href="#cb42-518"></a><span class="in">```</span></span>
<span id="cb42-519"><a href="#cb42-519"></a></span>
<span id="cb42-520"><a href="#cb42-520"></a><span class="fu">### Exercise</span></span>
<span id="cb42-521"><a href="#cb42-521"></a></span>
<span id="cb42-522"><a href="#cb42-522"></a>::: callout-note</span>
<span id="cb42-523"><a href="#cb42-523"></a>Go to the GSS website and describe the values of <span class="in">`attend`</span> and <span class="in">`polviews`</span>---e.g., what does a value of "4" mean in <span class="in">`polviews`</span>.</span>
<span id="cb42-524"><a href="#cb42-524"></a>:::</span>
<span id="cb42-525"><a href="#cb42-525"></a></span>
<span id="cb42-526"><a href="#cb42-526"></a><span class="fu">### Exercise</span></span>
<span id="cb42-527"><a href="#cb42-527"></a></span>
<span id="cb42-528"><a href="#cb42-528"></a>::: callout-note</span>
<span id="cb42-529"><a href="#cb42-529"></a>Repeat what we did in class with Steve, but compare the <span class="in">`weekly`</span> variable to a new variable call <span class="in">`conservative`</span>.</span>
<span id="cb42-530"><a href="#cb42-530"></a></span>
<span id="cb42-531"><a href="#cb42-531"></a><span class="ot">&lt;https://github.com/vaiseys/soc-stats-1/blob/main/demos/day-12.R&gt;</span></span>
<span id="cb42-532"><a href="#cb42-532"></a>:::</span>
<span id="cb42-533"><a href="#cb42-533"></a></span>
<span id="cb42-534"><a href="#cb42-534"></a>::: callout-tip</span>
<span id="cb42-535"><a href="#cb42-535"></a>Hint: You will have to create the <span class="in">`conservative`</span> value yourself by modifying the <span class="in">`polviews variable.`</span></span>
<span id="cb42-536"><a href="#cb42-536"></a>:::</span>
<span id="cb42-537"><a href="#cb42-537"></a></span>
<span id="cb42-538"><a href="#cb42-538"></a><span class="fu">### Exercise</span></span>
<span id="cb42-539"><a href="#cb42-539"></a></span>
<span id="cb42-540"><a href="#cb42-540"></a>::: callout-note</span>
<span id="cb42-541"><a href="#cb42-541"></a>Is the difference in proportions between <span class="in">`conservative`</span> and <span class="in">`weekly`</span> statistically significant?</span>
<span id="cb42-542"><a href="#cb42-542"></a>:::</span>
<span id="cb42-543"><a href="#cb42-543"></a></span>
<span id="cb42-544"><a href="#cb42-544"></a><span class="fu">### Exercise</span></span>
<span id="cb42-545"><a href="#cb42-545"></a></span>
<span id="cb42-546"><a href="#cb42-546"></a>::: callout-note</span>
<span id="cb42-547"><a href="#cb42-547"></a>Instead of discretizing the <span class="in">`polviews`</span> and <span class="in">`attend`</span> (which is what we did to create <span class="in">`weekly`</span> and <span class="in">`conservative`</span>), let's try interpreting their original values.</span>
<span id="cb42-548"><a href="#cb42-548"></a></span>
<span id="cb42-549"><a href="#cb42-549"></a>I made the following plot using <span class="in">`geom_tile`</span> to make the point that contingency tables are hard to interpret.</span>
<span id="cb42-550"><a href="#cb42-550"></a></span>
<span id="cb42-551"><a href="#cb42-551"></a>Try to describe what's going on here.</span>
<span id="cb42-552"><a href="#cb42-552"></a>:::</span>
<span id="cb42-553"><a href="#cb42-553"></a></span>
<span id="cb42-556"><a href="#cb42-556"></a><span class="in">```{r}</span></span>
<span id="cb42-557"><a href="#cb42-557"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb42-558"><a href="#cb42-558"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb42-559"><a href="#cb42-559"></a><span class="co">#| column: page</span></span>
<span id="cb42-560"><a href="#cb42-560"></a><span class="co">#| fig-align: center</span></span>
<span id="cb42-561"><a href="#cb42-561"></a><span class="co">#| echo: false</span></span>
<span id="cb42-562"><a href="#cb42-562"></a></span>
<span id="cb42-563"><a href="#cb42-563"></a><span class="fu">source</span>(<span class="st">"week6_plot_function.R"</span>)</span>
<span id="cb42-564"><a href="#cb42-564"></a>d <span class="sc">|&gt;</span> <span class="fu">plot_contingency_table</span>(polviews, attend)</span>
<span id="cb42-565"><a href="#cb42-565"></a><span class="in">```</span></span>
<span id="cb42-566"><a href="#cb42-566"></a></span>
<span id="cb42-567"><a href="#cb42-567"></a>::: callout-tip</span>
<span id="cb42-568"><a href="#cb42-568"></a>Hint: You can get the same values in this plot with the <span class="in">`tabyl()`</span> function from the <span class="in">`janitor`</span> package.</span>
<span id="cb42-569"><a href="#cb42-569"></a>:::</span>
<span id="cb42-570"><a href="#cb42-570"></a></span>
<span id="cb42-571"><a href="#cb42-571"></a><span class="fu">### Bonus</span></span>
<span id="cb42-572"><a href="#cb42-572"></a></span>
<span id="cb42-573"><a href="#cb42-573"></a>::: callout-note</span>
<span id="cb42-574"><a href="#cb42-574"></a>Do a Chi square test on <span class="in">`polviews`</span> and <span class="in">`attend`</span> using the <span class="in">`infer`</span> package.</span>
<span id="cb42-575"><a href="#cb42-575"></a></span>
<span id="cb42-576"><a href="#cb42-576"></a>The null hypothesis is that these variables are "independent" of each other.</span>
<span id="cb42-577"><a href="#cb42-577"></a>:::</span>
<span id="cb42-578"><a href="#cb42-578"></a></span>
<span id="cb42-579"><a href="#cb42-579"></a>::: callout-tip</span>
<span id="cb42-580"><a href="#cb42-580"></a>Hint: You may have to transform both <span class="in">`polviews`</span> and <span class="in">`attend`</span> into "factor" variables.</span>
<span id="cb42-581"><a href="#cb42-581"></a></span>
<span id="cb42-584"><a href="#cb42-584"></a><span class="in">```{r}</span></span>
<span id="cb42-585"><a href="#cb42-585"></a><span class="co">#| eval: false</span></span>
<span id="cb42-586"><a href="#cb42-586"></a></span>
<span id="cb42-587"><a href="#cb42-587"></a>d <span class="ot">&lt;-</span> d <span class="sc">|&gt;</span> </span>
<span id="cb42-588"><a href="#cb42-588"></a>  <span class="fu">mutate</span>(<span class="at">polviews =</span> <span class="fu">as_factor</span>(polviews),</span>
<span id="cb42-589"><a href="#cb42-589"></a>         <span class="at">attend =</span> <span class="fu">as_factor</span>(attend))</span>
<span id="cb42-590"><a href="#cb42-590"></a></span>
<span id="cb42-591"><a href="#cb42-591"></a><span class="in">```</span></span>
<span id="cb42-592"><a href="#cb42-592"></a>:::</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>